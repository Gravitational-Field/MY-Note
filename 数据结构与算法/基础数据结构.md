# 堆数据结构
[「图解数据结构」堆 (qq.com)](https://mp.weixin.qq.com/s/C7ZkHXuOeLI6b7CWQSX1Lw)

**什么是堆？**
堆是一种满足特殊条件的树。
这种树的任意一个节点的值都大于等于（或小于等于）子树中所有节点的值。

通常我们使用完全二叉树（叶子节点只出现在最下层或者次下层，且最下层的叶子节点都位于左侧）的形式来表示堆。

![[Pasted image 20210530212742.png]]
1是大顶堆；2是小顶堆；3不是堆。

**什么时候使用堆？**
关心数据的最大值和最小值；需要插入或删除数据。

和有序数组进行对比：
初始化有序数组时间复杂度O(nlog(n))；查找最大值和最小值时间复杂度为O(1);更新、修改和删除时间复杂度为O(n).

堆的优势：更新数据效率高。堆的初始化时间复杂度为 `O(nlog(n))`，堆可以做到`O(1)`时间复杂度取出最大值或者最小值，`O(log(n))`时间复杂度更新、插入或者删除数据。

**堆是怎么分类的？**
大顶堆：堆中的每一个节点的值都大于等于子树中所有节点的值
小顶堆：堆中的每一个节点的值都小于等于子树中所有节点的值


**堆是怎么存储的？**
由于完全二叉树的优秀性质，使用数组存储堆方便索引，也节省空间。
存储方式如下：
![[Pasted image 20210530220441.png]]


**堆的操作**

- 插入元素
步骤：
1、将要插入的元素放到最后
2、从底向上，如果父节点比该元素小，则父节点和该节点交换值。直到无法交换。

- 删除堆顶元素
以大顶堆为例（小顶堆同理）：
当删除了堆顶元素，最大值的位置发生空缺，需要进行结构调整从而保持堆的结构。这一过程称为堆化。
堆化分类:

- 自底向上（填充值从底向上，能者居上）
比较根节点的左右子节点，大的填充；不断循环，直到堆到最底部。（但是可能产生气泡现象）

- **自顶向下（填充值从顶向下走，石沉大海）**
将最后一个元素移动到堆顶，不停与左右子节点的值进行比较，和较大的子节点交换位置，直到无法交换位置。


**堆排序**
堆排序的过程分为两步：
>-   第一步是建堆，将一个无序的数组建立为一个堆
>-   第二步是排序，将堆顶元素取出，然后对剩下的元素进行堆化，反复迭代，直到所有元素被取出为止。

建堆：
首先要了解哪些是非叶节点，最后一个节点的父结点及它之前的元素，都是非叶节点。也就是说，如果节点个数为 n，那么我们需要对 n/2 到 1 的节点进行自顶向下（沉底）堆化。
将初始的无序数组抽象为一棵树，选取非叶节点，顺序是从后往前堆化，直至到达根节点。

排序：







